<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scientific Calculator</title>
<style>
    body {
        background: #222;
        color: white;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 10px;
    }
    .calculator {
        background: #333;
        padding: 20px;
        border-radius: 10px;
        width: 360px;
    }
    .display {
        background: black;
        color: lime;
        font-size: 1.8em;
        padding: 15px;
        text-align: right;
        border-radius: 5px;
        margin-bottom: 15px;
        overflow-x: auto;
    }
    .keys {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
    }
    .var-panel {
        margin-top: 15px;
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 5px;
    }
    button {
        padding: 12px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        background: #555;
        color: white;
        cursor: pointer;
    }
    button:hover {
        background: #777;
    }
</style>
</head>
<body>

<div class="calculator">
    <div id="display" class="display">0</div>
    <div class="keys">
        <button>(</button> <button>)</button> <button>π</button> <button>EE</button> <button>ANS</button> <button>C</button>
        <button>sin</button> <button>cos</button> <button>tan</button> <button>asin</button> <button>acos</button> <button>atan</button>
        <button>log</button> <button>ln</button> <button>10^</button> <button>e^</button> <button>√</button> <button>∛</button>
        <button>^</button> <button>!</button> <button>M+</button> <button>M-</button> <button>MR</button> <button>STORE</button>
        <button>7</button> <button>8</button> <button>9</button> <button>/</button> <button>⌫</button> <button>Rnd</button>
        <button>4</button> <button>5</button> <button>6</button> <button>*</button> <button colspan="2">ENG</button>
        <button>1</button> <button>2</button> <button>3</button> <button>-</button> <button>=</button>
        <button>0</button> <button>.</button> <button>+/-</button> <button>+</button>
    </div>
</div>

<div class="var-panel" id="var-panel"></div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    let display = document.getElementById('display');
    let expression = "";
    let memory = 0;
    let ans = 0;
    let variables = {};

    // Create variable buttons a-z
    const varPanel = document.getElementById('var-panel');
    for (let ch = 97; ch <= 122; ch++) { // ASCII a-z
        let btn = document.createElement('button');
        btn.textContent = String.fromCharCode(ch);
        btn.addEventListener('click', () => {
            expression += btn.textContent;
            display.textContent = expression;
        });
        varPanel.appendChild(btn);
        variables[String.fromCharCode(ch)] = 0;
    }

    function updateDisplay(val) {
        display.textContent = val || "0";
    }

    function safeEval(expr) {
        let replaced = expr
            .replace(/π/g, Math.PI)
            .replace(/EE/g, Math.E)
            .replace(/sin\(/g, "Math.sin(")
            .replace(/cos\(/g, "Math.cos(")
            .replace(/tan\(/g, "Math.tan(")
            .replace(/asin\(/g, "Math.asin(")
            .replace(/acos\(/g, "Math.acos(")
            .replace(/atan\(/g, "Math.atan(")
            .replace(/log\(/g, "Math.log10(")
            .replace(/ln\(/g, "Math.log(")
            .replace(/√/g, "Math.sqrt")
            .replace(/∛/g, "Math.cbrt")
            .replace(/10\^/g, "(10**")
            .replace(/e\^/g, (Math.E**)
            .replace(/\^/g, "")
            .replace(/Rnd/g, Math.random())
            .replace(/([a-z])/g, match => variables[match] ?? match); // replace variables

        return eval(replaced);
    }

    document.querySelectorAll('.keys button').forEach(btn => {
        btn.addEventListener('click', () => {
            let val = btn.textContent;

            try {
                if (val === "C") {
                    expression = "";
                    updateDisplay(expression);
                }
                else if (val === "⌫") {
                    expression = expression.slice(0, -1);
                    updateDisplay(expression);
                }
                else if (val === "=") {
                    let result = safeEval(expression);
                    ans = result;
                    expression = result.toString();
                    updateDisplay(result);
                }
                else if (val === "ANS") {
                    expression += ans;
                    updateDisplay(expression);
                }
                else if (val === "M+") {
                    memory += parseFloat(display.textContent) || 0;
                }
                else if (val === "M-") {
                    memory -= parseFloat(display.textContent) || 0;
                }
                else if (val === "MR") {
                    expression += memory;
                    updateDisplay(expression);
                }
                else if (val === "STORE") {
                    let varName = prompt("Enter variable name (a-z):");
                    if (varName && /^[a-z]$/.test(varName)) {
                        variables[varName] = parseFloat(display.textContent) || 0;
                    }
                }
                else if (val === "+/-") {
                    if (expression.startsWith("-")) {
                        expression = expression.slice(1);
                    } else {
                        expression = "-" + expression;
                    }
                    updateDisplay(expression);
                }
                else {
                    expression += val;
                    updateDisplay(expression);
                }
            } catch (err) {
                updateDisplay("Error");
                expression = "";
            }
        });
    });
});
</script>
</body>
</html>
